<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Cập nhật tài khoản người dùng</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;900&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-4">

<h2 class="mb-4">Cập nhật tài khoản người dùng</h2>

<!-- FORM TÌM KIẾM -->
<form method="get" action="/admin/users" class="row mb-3 justify-content-end">
  <div class="col-md-6">
    <input type="text" name="keyword" class="form-control" placeholder="Tìm theo tên khách hàng hoặc ID..." th:value="${keyword}">
  </div>
  <div class="col-md-2">
    <button type="submit" class="btn btn-primary">Tìm kiếm</button>
  </div>
</form>

<!-- BUTTON THÊM MỚI TÀI KHOẢN NHÂN VIÊN -->
<div class="mb-4 text-end">
  <a href="/admin/users/create-employee" class="btn btn-success">Thêm tài khoản Nhân viên</a>
</div>

<!-- ROLE SELECTION BUTTONS -->
<div class="mb-3">
  <form method="get" action="/admin/users" class="d-inline">
    <input type="hidden" name="role" value="customer" />
    <button type="submit" class="btn btn-info">Danh sách Khách hàng</button>
  </form>

  <form method="get" action="/admin/users" class="d-inline ms-2">
    <input type="hidden" name="role" value="employee" />
    <button type="submit" class="btn btn-info">Danh sách Nhân viên</button>
  </form>
</div>

<!-- DANH SÁCH NGƯỜI DÙNG -->
<table class="table table-bordered table-striped">
  <thead class="table-light">
  <tr>
    <th>ID</th>
    <th>Tên đăng nhập</th>
    <th>Email</th>
    <th>Vai trò</th>
    <th>Hành động</th>
  </tr>
  </thead>
  <tbody>
  <tr th:each="user : ${users}">
    <form th:action="@{/admin/users/save}" method="post">
      <td><input type="hidden" name="id" th:value="${user.id}"/> <span th:text="${user.id}"></span></td>
      <td><input type="text" name="username" th:value="${user.username}" class="form-control" /></td>
      <td><input type="text" name="email" th:value="${user.email}" class="form-control" /></td>
      <td><input type="text" name="role" th:value="${user.role}" class="form-control" /></td>
      <td>
        <button type="submit" class="btn btn-warning btn-sm">Lưu</button>
      </td>
    </form>
  </tr>
  </tbody>
</table>

<!-- PAGINATION -->
<div class="d-flex justify-content-center">
  <nav>
    <ul class="pagination">
      <li class="page-item" th:if="${currentPage > 1}">
        <a class="page-link" th:href="@{/admin/users(page=${currentPage - 1})}">Previous</a>
      </li>
      <li class="page-item" th:each="i : ${#numbers.sequence(1, totalPages)}" th:classappend="${i == currentPage} ? 'active' : ''">
        <a class="page-link" th:href="@{/admin/users(page=${i})}" th:text="${i}"></a>
      </li>
      <li class="page-item" th:if="${currentPage < totalPages}">
        <a class="page-link" th:href="@{/admin/users(page=${currentPage + 1})}">Next</a>
      </li>
    </ul>
  </nav>
</div>

<!-- BACK BUTTON at the bottom, aligned to the right -->
<div class="mb-3 text-end">
  <button type="button" class="btn btn-secondary" onclick="window.history.back()">Quay lại</button>
</div>

</body>
</html>
